{% set current_route = app.request.get('_route') %}
{% set current_path = app.request.uri %}
{% set current_locale = app.request.get('_locale') %}

<!DOCTYPE html>
<html lang="{{ current_locale }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{% endblock %} | Informatics.Ge</title>
    <meta name="description" content="Informatics.ge - პროგრამირების შესწავლისა და სპორტული პროგრამირების ვებ-გვერდი">
    <meta name="keywords"
          content="პროგრამირება, პროგრამირების ენები, პროგრამირების შესწავლა, სპორტული პროგრამირება, ოლიმპიადები პროგრამირებაში, კონტესტები, ალგორითმები, ალგორითმი">
    <meta name="author" content="ABGEO">

    <!-- Icons -->
    <link href="{{ asset('images/blue-robot-hi.png') }}" rel="icon" type="image/x-icon">
    <!-- Icons -->

    <!-- Styles -->
    {% block styles %}
        <link href="{{ asset('css/font-awesome.min.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ asset('css/bootstrap.min.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ asset('css/imagehover.min.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ asset('css/style.css') }}" rel="stylesheet" type="text/css">
        <link href="{{ asset('https://fonts.googleapis.com/css?family=Open+Sans|Candal|Alegreya+Sans') }}"
              rel="stylesheet" type="text/css">
    {% endblock %}
    <!-- / Styles -->
</head>

<body>

<!--Facebook SDK-->
<div id="fb-root"></div>

{% set facebookSDKLangs = {
    ka: 'ka_GE',
    en: 'en_GB'
} %}

<script async defer crossorigin="anonymous" src="https://connect.facebook.net/{{ facebookSDKLangs[current_locale] }}/sdk.js#xfbml=1&version=v3.3&appId={{ getEnv('FB_APP_ID') }}&autoLogAppEvents=1"></script>
<!--/ Facebook SDK-->

<!--Navigation bar-->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <div class="logo-with-lang-switcher">
                <a class="navbar-brand" href="{{ url('index') }}">I<span>nformatics</span>.ge</a>

                {% set query_params = app.request.query.all|url_encode is not empty ?
                    '?' ~ app.request.query.all|url_encode : app.request.query.all|url_encode %}

                {% if app.request.attributes.get('_locale') == 'en' %}
                    <a href="{{ path(current_route, app.request.get('_route_params')|merge({'_locale': 'ka'})) ~ query_params }}"
                       class="lang-item">
                        <img src="{{ asset('images/lang-ka.png') }}" alt="KA"/>
                    </a>
                {% elseif app.request.attributes.get('_locale') == 'ka' %}
                    <a href="{{ path(current_route, app.request.get('_route_params')|merge({'_locale': 'en'})) ~ query_params }}"
                       class="lang-item">
                        <img src="{{ asset('images/lang-en.png') }}" alt="EN"/>
                    </a>
                {% endif %}
            </div>

        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav navbar-right">
                <li class="{{ current_route == 'index' ? 'active' : '' }}"><a
                            href="{{ url('index') }}">{{ 'homepage'|trans }}</a></li>
                <li class="{{ current_route in ['material_index', 'material_problems', 'material_single_problem', 'material_algorithms'] ? 'active' : '' }}">
                    <a href="{{ url('material_index') }}">{{ 'materials'|trans }}</a></li>
                <li class="{{ current_route == 'about' ? 'active' : '' }}"><a
                            href="{{ url('about') }}">{{ 'we'|trans }}</a></li>

                {% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}
                    <li class="dropdown">
                        <a class="dropdown-toggle link-trial" data-toggle="dropdown" href="#">
                            {{ app.user.username }}
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu navbar-nav">
                            {% if is_granted(['ROLE_ADMIN', 'ROLE_SUPER_ADMIN']) %}
                                <li><a href="{{ path('sonata_admin_dashboard') }}">{{ 'admin_panel'|trans }}</a></li>
                            {% endif %}
                            <li class="{{ current_route == 'user_profile' and app.user.username == app.request.get('username') ? 'active' : '' }}">
                                <a href="{{ path('user_profile', { 'username' : app.user.username }) }}">{{ 'my_profile'|trans }}</a>
                            </li>
                            <li><a href="{{ path('app_logout') }}" style="color: red;">{{ 'logout'|trans }}</a></li>
                        </ul>
                    </li>
                {% else %}
                    <li class="btn-trial"><a href="{{ path('sign_in') }}">{{ 'sign_in_txt'|trans }}</a></li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>
<!--/ Navigation bar-->

<!--Main Section-->
<section class="section-padding">
    <div class="container">
        <div class="row">
            <!--Flush Messages-->
            <div class="col-md-12 text-center">
                {% for type, messages in app.flashes() %}
                    {% for message in messages %}
                        <div class="alert alert-{{ type }}">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                            {{ message|trans([], 'flushes') }}
                        </div>
                    {% endfor %}
                {% endfor %}
            </div>
            <!--/ Flush Messages-->

            <!--Content-->
            {% block body %}{% endblock %}
            <!--/ Content-->
        </div>
    </div>
</section>
<!--/ Main Section-->

<!--Scripts-->
{% block javascripts %}
    <script src="{{ asset('js/jquery.min.js') }}"></script>
    <script src="{{ asset('js/jquery.easing.min.js') }}"></script>
    <script src="{{ asset('js/bootstrap.min.js') }}"></script>
    <script src="{{ asset('https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.js') }}"></script>
{% endblock %}
<!--/ Scripts-->

<!--Footer-->
<footer id="footer" class="footer">
    <div class="container text-center">
        <div class="partners">
            <h2>{{ 'our_partners'|trans }}</h2>
            <section class="partner-logos slider">
                <div class="slide">
                    <a href="http://kings.ge" target="_blank">
                        <img src="{{ asset('images/partners/kings.svg') }}" alt="Kings.ge"/>
                    </a>
                </div>
                <div class="slide">
                    <a href="http://lupi.ge" target="_blank">
                        <img src="{{ asset('images/partners/lupi.png') }}" alt="Lupi.ge"/>
                    </a>
                </div>
            </section>

            <script>
                $(document).ready(function () {
                    $('.partner-logos').slick({
                        centerMode: true,
                        slidesToShow: 6,
                        slidesToScroll: 1,
                        autoplay: true,
                        autoplaySpeed: 2000,
                        arrows: false,
                        dots: false,
                        pauseOnHover: false,
                        responsive: [
                            {
                                breakpoint: 768,
                                settings: {
                                    slidesToShow: 4
                                }
                            },
                            {
                                breakpoint: 520,
                                settings: {
                                    slidesToShow: 3
                                }
                            }]
                    });
                });
            </script>
        </div>

        <ul class="social-links">
            <li><a href="#" target="_blank"><i class="fa fa-facebook fa-fw"></i></a></li>
            <li><a href="#"><i class="fa fa-instagram fa-fw"></i></a></li>
            <li><a href="#"><i class="fa fa-twitter fa-fw"></i></a></li>
        </ul>

        <div class="credits">
            <p>©2018-{{ 'now'|date('Y') }} Informatics.ge. {{ 'all_rights_reserved'|trans }}</p>
            <p><b>{{ 'server_time'|trans }}: {{ 'now'|date("d.m.Y H:i:s") }}</b></p>
        </div>

        <div class="links">
            <p>
                <a href="{{ url('about') }}">{{ 'about_us'|trans }}</a> |
                <a href="#">{{ 'confidentiality'|trans }}</a> |
                <a href="#">{{ 'terms_and_conditions'|trans }}</a>
            </p>
            <p><a href="https://old.informatics.ge">{{ 'site_old_version'|trans }}</a></p>
            <p>
                Create with <span style="color: red;">♥</span> By
                <a href="https://www.abgeo.dev/" target="_blank">ABGEO</a>
            </p>
        </div>
    </div>
</footer>
<!--/ Footer-->
</body>
</html>
